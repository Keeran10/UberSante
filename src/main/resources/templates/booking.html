<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Bookings</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" type="text/css" href="appointment_css.css"/>

    <link rel="stylesheet" type="text/css" href="../home_css.css"/>
    <script src="https://code.jquery.com/jquery-1.11.0.min.js" type="text/javascript"></script>
    <script src="https://code.jquery.com/ui/1.10.4/jquery-ui.min.js" type="text/javascript"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"/>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <meta charset="UTF-8"/>
</head>
<body>

<div th:if="${user.userType} == 'patient'" th:replace="fragments/cart::cart"></div> <!-- cart-->
<div class="wrap">
    <div class="header">

        <div class ="image"><img src="https://bonjour-sante.ca/uno/dist/images/8fc999dfe2bfdae49d12e32e303b77a6.jpg" height="200" /></div>
    </div>

    <!--  th:if="${user}" will add once backend is established-->
    <div class="navigation-bar" th:if="${user}"> <!-- if user exists then go inside the div, else skip -->
        <ul>

            <li><a class="active" href="/home">Home</a></li>
            <div th:if="${user}">
                <li th:if="${user.userType} == 'doctor'"><a th:with="baseUrl=('/schedule/'+${user.userId})"
                                                            th:href="@{${baseUrl}}">Schedule Manager</a></li>


            </div>
            <div th:if="${user.userType} == 'patient'">
                <!-- th:if="${user.userType} == 'patient'"> will add once backend is established -->
                <li><a href="/showBookings">Bookings</a></li>
            </div>
            <div th:if="${user.userType} == 'patient'">
                <!-- th:if="${user.userType} == 'patient'"> will add once backend is established -->
                <li><a href="/appointment_page">Appointments</a></li>
            </div>

            <li><a href="/contact">Contact</a></li>
            <li><a href="/about">About</a></li>
            <li style="float:right"><a href="/login" >Logout</a></li>
            <li th:if="${user.userType} == 'patient'"><a id="cartToggle">Cart</a></li>

        </ul>
    </div>

    <div class="navigation-bar-default" th:if="!${user}"> <!-- if user doesn't exists then go inside this div -->
        <ul>

            <li><a class="active" href="/home">Home</a></li>
            <li><a href="/register">Register</a></li>
            <li><a href="/login">Login</a></li>
            <li><a href="/contact">Contact</a></li>
            <li><a href="/about">About</a></li>

        </ul>
    </div>


    <div class="main">


        <div class="navigation-bar" th:if="${user}"> <!--// if user exists then go inside the div, else skip-->

            <div th:if="${user.userType} == 'patient'">
                <h3 th:text=" 'Welcome ' +  ${user.firstName}+' '+${user.lastName}">Hi, Name Space Last</h3>
            </div>
            <div th:if="${user.userType} == 'doctor'">
                <h3 th:text=" 'Welcome back Doctor ' + ${user.lastName}">Hi, User</h3>
            </div>
            <div th:if="${user.userType} == 'nurse'">
                <h3 th:text=" 'Welcome back Nurse ' + ${user.lastName}">Hi, User</h3>
            </div>
        </div>
        <div th:unless="${user}">
            <h3>Welcome to UberSante</h3>
        </div>

        <h1 align="center">Your Bookings</h1>

        <table>
            <!-- Cart.html -->
            <head>
                <title>UberSante</title>
                <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
            </head>
            <body>
            <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
            <div class="container">
                <div id="cart-panel" th:fragment="cart">
                    <link rel="stylesheet" type="text/css" href="/fragments/cart_css.css" th:href="@{/fragments/cart_css.css}"/>
                    <div class="wrapper">
                        <h2>Cart</h2>
                        <div class="cart-wrapper">
                            <table class="cart-table">
                                <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Start-Time</th>
                                    <th>End-Time</th>
                                    <th>Type</th>
                                    <th>Doctor</th>
                                    <th>Room</th>
                                    <th></th>
                                    <th></th>
                                    <th></th>
                                </tr>
                                </thead>
                                <td th:each="booking : ${bookings}">
                                <td th:text="${booking.date}"></td>
                                <td th:text="${booking.startTime}"></td>
                                <td th:text="${booking.endTime}"></td>
                                <td th:text="${booking.bookingType}"></td>
                                <td th:text="${booking.doctor}"></td>
                                <td th:text="${booking.room}"></td>

                                <td>
                                    <a th:if="${user.UserType} == 'nurse'"
                                       th:href="@{/updateBooking(id=${booking.bookingId})}"><button>Update</button></a>
                                </td>
                                <td>
                                    <a th:if="${user.UserType} == 'nurse'"
                                       th:href="@{/removeBooking(id=${booking.bookingId})}"><button>Remove</button></a>
                                </td>

                                <td>
                                    <a th:if="${user.UserType} == 'doctor'"
                                       th:href="@{/followupBooking(id=${booking.bookingId})}"><button>Follow Up</button></a>
                                </td>
                                </td>
                            </table>
                        </div>
                        <br/>
                    </div>
                </div>
            </div>
            </body>
        </table>




        <div>
            <!-- Cart Slider -->
            <script>
                $('#cartToggle').on('click', function(){
                    var $this = $('#cart-panel');
                    if ($this.hasClass('open')) {
                        $this.animate({
                            left : '800px'
                        }, 150).removeClass('open');
                    } else {
                        $this.animate({
                            left : '17px'
                        }, 150).addClass('open');
                    }
                });
            </script>
        </div>
    </div>
</div>


</body>
</html>